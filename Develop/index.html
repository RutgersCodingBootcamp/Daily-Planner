<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Favorite Movies</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0/css/bootstrap.min.css"
    />
    <link rel="stylesheet" href="style.css" />
  </head>

  <body>
    <div class="container">
      <div class="jumbotron">
        <h1>Daily Planner</h1>
        <h2 id="date">Today's Date</h2>
      </div>
      <table class="table"></table>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script type="text/javascript">
      //on button press save textbox to local storge and set textbox placeholder to text entered

      //display the current day
      var dateObj = new Date();
      var hours = [
        { string: "9AM", value: 9, text: "" },
        { string: "10AM", value: 10, text: "" },
        { string: "11AM", value: 11, text: "" },
        { string: "12PM", value: 12, text: "" },
        { string: "1PM", value: 13, text: "" },
        { string: "2PM", value: 14, text: "" },
        { string: "3PM", value: 15, text: "" },
        { string: "4PM", value: 16, text: "" },
        { string: "5PM", value: 17, text: "" },
      ];
      getCurrentDay();
      function getCurrentDay() {
        var monthName = [
          "January",
          "February",
          "March",
          "April",
          "May",
          "June",
          "July",
          "August",
          "September",
          "October",
          "November",
          "December",
        ];
        var month = dateObj.getMonth(); //months from 1-12
        var day = dateObj.getDate();
        var year = dateObj.getFullYear();

        var date = $("<h3>");
        date.text(monthName[month] + " " + day + ", " + year);
        $("#date").append(date);
      }
      //Add rows to the table element known as  a timeblock
      displayRows();

      function displayRows() {
        var localContent = localStorage.getItem("hourData");
        //This checks for a local data save if not there than 
        if (!localContent) {
          localContent = hours;
        } else {
          localContent = JSON.parse(localContent);
        }

        var tBody = $(".table");
        //for loop for all the rows
        for (var i = 0; i < hours.length; i++) {
          var block = hours[i];

          //I can build an array
          //I need to access the individual elements built

          //Each time slot
          var tbRow = $("<tr>");
          tbRow.addClass("center");
          //Time
          var hour = $("<td>");
          hour.addClass("hour time-blocks");
          hour.text(hours[i].string);
          tbRow.append(hour);

          //Text Area
          var textDiv = $("<td>");
          var textArea = $("<textarea>");
          textArea.addClass("textBox");
          var text = $(".textBox").val();
          block.text = text;
          //set the text value of text area to the block.text
          textDiv.append(textArea);

          tbRow.append(textDiv);

          //Save Button
          var saveBtn = $("<td><span>Save</span></td>");
          saveBtn.addClass("saveBtn");
          //saveBtn.text("Save");
          tbRow.append(saveBtn);

          //Check whether past present or future

          if (block.value === dateObj.getHours()) {
            textDiv.addClass("present");
          }
          if (block.value > dateObj.getHours()) {
            textDiv.addClass("future");
          }
          if (block.value < dateObj.getHours()) {
            textDiv.addClass("past");
          }
          //Save items to local storage in object called blockData

          tBody.append(tbRow);
        }
      }

      //Change the time into according to current time
      //Can I Set a time to equal a string
      //1- get time
      // lock in the text area (save in Local Storage)
      //use this to access local storage and display
      $(".saveBtn").on("click", function () {
        //I need the value of hours[i].time
        displayRows();

        var localContent = localStorage.getItem("content");

        if (!localContent) {
          localContent = [];
        } else {
          localContent = JSON.parse(localContent);
        }
        //On a button press set text content of textbox

        localContent.push(hours);
        localStorage.setItem("hourData", JSON.stringify(localContent));
        console.log(localContent);
      });
    </script>
  </body>
</html>
